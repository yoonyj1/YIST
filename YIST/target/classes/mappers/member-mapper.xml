<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"mybatis-3-mapper.dtd" >

<mapper namespace="memberMapper">

	<resultMap id="memberResultSet" type="Member">
		<result column="user_id" property="userId"></result>
		<result column="user_pwd" property="userPwd"></result>
		<result column="user_name" property="userName"></result>
		<result column="email" property="email"></result>
		<result column="gender" property="gender"></result>
		<result column="age" property="age"></result>
		<result column="phone" property="phone"></result>
		<result column="address" property="address"></result>
		<result column="enroll_date" property="enrollDate"></result>
		<result column="modify_date" property="modifyDate"></result>
		<result column="status" property="status"></result>
	</resultMap>


	<select id="loginMember" resultMap="memberResultSet">
		select
		user_id
		, user_pwd
		, user_name
		, email
		, gender
		, age
		, phone
		, address
		, enroll_date
		, modify_date
		, status
		from member
		where user_id = #{userId}
		and user_pwd = #{userPwd}
		and status = 'Y'
	</select>

	<insert id="insertMember">
		insert
		into member
		(
		user_id
		, user_pwd
		, user_name
		, email
		, gender
		, age
		, phone
		, address
		)
		values
		(
		#{userId}
		, #{userPwd}
		, #{userName}
		, #{email}
		, #{gender}
		, #{age}
		, #{phone}
		, #{address}
		)
	</insert>

	<update id="updateMember">
		update
		member
		set user_name = #{userName}
		, email = #{email}
		, age = #{age}
		, phone = #{phone}
		, address = #{address}
		, gender = #{gender}
		, modify_date = sysdate
		where user_id = #{userId} and status = 'Y'
	</update>

	<delete id="deleteMember">
		update
		member
		set status = 'N'
		where user_id = #{userId}
	</delete>

	<select id="idCheck" resultType="_int">
		select count(*)
		from member
		where
		user_id = #{checkId}
	</select>

	<!-- public List<Member> listMember(); -->
	<select id="listMember" resultType="kr.or.bit.dto.Member">
		select userid, pwd, name from member_alert
	</select>

	<!-- public int getmsgcount(String userid); -->
	<select id="getmsgcount" resultType="int">
		select count(*) from message where m_from = #{userid}
	</select>

	<!-- public int insertMessage(Message message) -->
	<insert id="insertMessage">
		insert into message(m_to, m_from, msg)
		values(
		#{m_to},
		#{m_from},
		#{msg}
		)
	</insert>

	<!-- public List<Message> listMessage(String userid) -->
	<select id="listMessage" resultType="Message">
		select m_to, m_from, msg, m_check from message where m_from = #{userid}
	</select>

	<!-- public int updateMessage(String userid) -->
	<update id="updateMessage">
		update message set m_check=1 where m_from = #{userid}
	</update>
</mapper>

























