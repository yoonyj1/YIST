<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"mybatis-3-mapper.dtd" >

<mapper namespace="memberMapper">

	<resultMap id="memberResultSet" type="Member">
		<result column="id" property="id"></result>
		<result column="name" property="name"></result>
		<result column="pwd" property="pwd"></result>
		<result column="birth" property="birth"></result>
		<result column="phone" property="phone"></result>
		<result column="image" property="image"></result>
		<result column="email" property="email"></result>
		<result column="post" property="post"></result>
		<result column="address" property="address"></result>
		<result column="detail_address" property="detailAddress"></result>
		<result column="subject" property="subject"></result>
		<result column="enroll_date" property="enrollDate"></result>
		<result column="start_date" property="startDate"></result>
		<result column="end_date" property="endDate"></result>
		<result column="status" property="status"></result>
		<result column="sort" property="sort"></result>
		<result column="employee_date" property="employeeDate"></result>
	</resultMap>

	<resultMap id="alarmResultSet" type="Alarm">
		<result column="alarm_no" property="alarmNo"></result>
		<result column="id" property="id"></result>
		<result column="alarm_content" property="alarmContent"></result>
		<result column="alarm_type" property="alarmType"></result>
		<result column="status" property="status"></result>
		<result column="create_date" property="createDate"></result>
	</resultMap>

	<select id="loginMember" resultMap="memberResultSet">
		select
				  id
				, name
				, pwd
				, birth
				, phone
				, image
				, email
				, post
				, address
				, detail_address
				, subject
				, enroll_date
				, start_date
				, end_date
				, status
				, sort
				, employee_date
		from member
		where id = #{id} and pwd = #{pwd} and status = 'Y' and sort = #{sort}
	</select>

	<insert id="insertMember">
		insert
		into member
		(
		user_id
		, user_pwd
		, user_name
		, email
		, gender
		, age
		, phone
		, address
		)
		values
		(
		#{userId}
		, #{userPwd}
		,
		#{userName}
		, #{email}
		, #{gender}
		, #{age}
		, #{phone}
		, #{address}
		)
	</insert>

	<update id="updateMember">
		update
		member
		set user_name = #{userName}
		, email =
		#{email}
		, age = #{age}
		, phone = #{phone}
		, address = #{address}
		, gender
		= #{gender}
		, modify_date = sysdate
		where user_id = #{userId} and status
		= 'Y'
	</update>

	<delete id="deleteMember">
		update
		member
		set status = 'N'
		where user_id = #{userId}
	</delete>

	<select id="idCheck" resultType="_int">
		select count(*)
		from member
		where
		user_id = #{checkId}
	</select>

	<!-- 알람삽입 -->
	<insert id="insertAlarm">
		insert 
			into alarm 
				values
				(
					seq_alarm_no.nextval
				  , #{id}
				  , #{alarmContent}
				  , #{alarmType}
				  , #{status}
				  , sysdate
				)
	</insert>

	<!-- 알람조회 -->
	<select id="selectAlarmList" resultMap="alarmResultSet">
		select
				alarm_no
				, id
				, alarm_content
				, alarm_type
				, status
				, create_date
				from alarm
		where id = 'user01' and status = 'N'
	</select>

</mapper>

























