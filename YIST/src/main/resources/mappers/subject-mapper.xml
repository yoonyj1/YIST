<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"mybatis-3-mapper.dtd" >

<mapper namespace="subjectMapper">
	
	<resultMap id="subjectResultSet" type="Subject">
		<result column="SUBJECT_NO" property="subjectNo"></result>
		<result column="CLASS_NO" property="classNo"></result>
		<result column="SUBJECT_NAME" property="subjectName"></result>
		<result column="START_DATE" property="startDate"></result>
		<result column="END_DATE" property="endDate"></result>
		<result column="STATUS" property="status"></result>
		<result column="DAY" property="day"></result>
		<result column="MAXIMUM_SEATS" property="maximumSeats"></result>
		<result column="CURRENT_SEATS" property="currentSeats"></result>
		<result column="FEE" property="fee"></result>
		<result column="INSTRUCTOR" property="instructor"></result>
	</resultMap>
	
	
	<update id="increaseCurrentSeats">
		update
				subject
		   set
		   		current_seats = current_seats+1
		 where
		 		subject_no = #{subjectNo} 			
	</update>
	
	<select id="selectSubjectListCount" resultType="_int">
		select
				count(*)
		  from subject
	</select>	
	
	<select id="selectSubjectList" resultMap="subjectResultSet">
		select
			SUBJECT_NO
			,CLASS_NO
			,SUBJECT_NAME
            ,NAME as INSTRUCTOR
			,TO_CHAR(s.START_DATE,'RRRR/MM/DD') as start_date
			,TO_CHAR(s.END_DATE,'RRRR/MM/DD') as end_date
			,DAY
			,MAXIMUM_SEATS
			,CURRENT_SEATS
			,FEE
		  from subject s 
          join member on(subject_no = subject)
         where s.status = 'Y' 
           and sort = 2  
		 order
		    by SUBJECT_NO desc          
	</select>
	

</mapper>